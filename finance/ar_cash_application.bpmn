<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
  targetNamespace="http://bpmn.io/schema/bpmn">

  <bpmn:process id="Process_AR_CashApp" name="AR â€” Cash Application" isExecutable="false">
    <bpmn:startEvent id="Start_PaymentReceived" name="Payment Received"/>
    <bpmn:task id="Task_IdentifyPayer" name="Identify Payer"/>
    <bpmn:task id="Task_ExtractRemittance" name="Extract Remittance (Bank/Email/Portal)"/>
    <bpmn:task id="Task_AttemptMatch" name="Attempt Match to Open Invoices"/>
    <bpmn:exclusiveGateway id="Gateway_MatchFound" name="Match Found?"/>
    <bpmn:task id="Task_HandleUnapplied" name="Route Unapplied Cash"/>
    <bpmn:task id="Task_PostToLedger" name="Post to AR Ledger"/>
    <bpmn:task id="Task_NotifyCustomer" name="Notify Customer (Receipt)"/>
    <bpmn:endEvent id="End_CashApplied" name="Cash Applied"/>
    
    <!-- Flows -->
    <bpmn:sequenceFlow id="F1" sourceRef="Start_PaymentReceived" targetRef="Task_IdentifyPayer"/>
    <bpmn:sequenceFlow id="F2" sourceRef="Task_IdentifyPayer" targetRef="Task_ExtractRemittance"/>
    <bpmn:sequenceFlow id="F3" sourceRef="Task_ExtractRemittance" targetRef="Task_AttemptMatch"/>
    <bpmn:sequenceFlow id="F4" sourceRef="Task_AttemptMatch" targetRef="Gateway_MatchFound"/>
    <bpmn:sequenceFlow id="F5_yes" name="Yes" sourceRef="Gateway_MatchFound" targetRef="Task_PostToLedger"/>
    <bpmn:sequenceFlow id="F6_no" name="No" sourceRef="Gateway_MatchFound" targetRef="Task_HandleUnapplied"/>
    <bpmn:sequenceFlow id="F7" sourceRef="Task_HandleUnapplied" targetRef="Task_AttemptMatch"/>
    <bpmn:sequenceFlow id="F8" sourceRef="Task_PostToLedger" targetRef="Task_NotifyCustomer"/>
    <bpmn:sequenceFlow id="F9" sourceRef="Task_NotifyCustomer" targetRef="End_CashApplied"/>
  </bpmn:process>

  <!-- DI layout -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_AR">
    <bpmndi:BPMNPlane id="BPMNPlane_AR" bpmnElement="Process_AR_CashApp">

      <bpmndi:BPMNShape id="DI_Start_PaymentReceived" bpmnElement="Start_PaymentReceived">
        <dc:Bounds x="120" y="170" width="36" height="36"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_IdentifyPayer" bpmnElement="Task_IdentifyPayer">
        <dc:Bounds x="190" y="150" width="150" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_ExtractRemittance" bpmnElement="Task_ExtractRemittance">
        <dc:Bounds x="370" y="150" width="230" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_AttemptMatch" bpmnElement="Task_AttemptMatch">
        <dc:Bounds x="640" y="150" width="210" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_GW_MatchFound" bpmnElement="Gateway_MatchFound" isMarkerVisible="true">
        <dc:Bounds x="880" y="165" width="50" height="50"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_HandleUnapplied" bpmnElement="Task_HandleUnapplied">
        <dc:Bounds x="860" y="280" width="190" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_PostToLedger" bpmnElement="Task_PostToLedger">
        <dc:Bounds x="960" y="150" width="170" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_Task_NotifyCustomer" bpmnElement="Task_NotifyCustomer">
        <dc:Bounds x="1160" y="150" width="220" height="80"/>
      </bpmndi:BPMNShape>

      <bpmndi:BPMNShape id="DI_End_CashApplied" bpmnElement="End_CashApplied">
        <dc:Bounds x="1410" y="170" width="36" height="36"/>
      </bpmndi:BPMNShape>

      <!-- Edges -->
      <bpmndi:BPMNEdge id="DI_F1" bpmnElement="F1">
        <di:waypoint x="156" y="188"/><di:waypoint x="190" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F2" bpmnElement="F2">
        <di:waypoint x="340" y="190"/><di:waypoint x="370" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F3" bpmnElement="F3">
        <di:waypoint x="600" y="190"/><di:waypoint x="640" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F4" bpmnElement="F4">
        <di:waypoint x="850" y="190"/><di:waypoint x="880" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F5_yes" bpmnElement="F5_yes">
        <di:waypoint x="930" y="190"/><di:waypoint x="960" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F6_no" bpmnElement="F6_no">
        <di:waypoint x="905" y="215"/><di:waypoint x="950" y="260"/><di:waypoint x="950" y="280"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F7" bpmnElement="F7">
        <di:waypoint x="1050" y="280"/><di:waypoint x="1050" y="230"/><di:waypoint x="840" y="230"/><di:waypoint x="840" y="190"/><di:waypoint x="850" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F8" bpmnElement="F8">
        <di:waypoint x="1130" y="190"/><di:waypoint x="1160" y="190"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DI_F9" bpmnElement="F9">
        <di:waypoint x="1380" y="190"/><di:waypoint x="1410" y="188"/>
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>